<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Labirynt Matematyczny 0–30</title>
  <style>
    :root {
      --cell-size: 44px;
      --border: #b8bcc2;
      --empty: transparent;
      --filled: #ffffff;
      --accent: #2a7de1;
      --good: #17723f;
      --bad: #b21c1c;
    }

    body {
      font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
      background: #ffffff;
      margin: 0;
      padding: 0;
      color: #1d1d1f;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: 24px 24px 12px;
    }

    h1 {
      margin: 0 0 8px;
      font-size: 26px;
    }

    p {
      margin: 0 0 10px;
      line-height: 1.5;
    }

    .status {
      font-weight: 600;
      margin-top: 6px;
    }

    .maze-wrapper {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 12px 24px 24px;
    }

    .maze {
      display: grid;
      grid-template-rows: repeat(var(--rows), var(--cell-size));
      grid-template-columns: repeat(var(--cols), var(--cell-size));
      gap: 0;
    }

    .cell {
      width: var(--cell-size);
      height: var(--cell-size);
      border: 2px solid var(--border);
      background: var(--filled);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: calc(var(--cell-size) * 0.45);
      font-weight: 600;
      color: #202227;
      box-sizing: border-box;
    }

    .cell.empty {
      border-color: transparent;
      background: var(--empty);
    }

    .cell input {
      width: 100%;
      height: 100%;
      border: none;
      background: transparent;
      text-align: center;
      font-size: calc(var(--cell-size) * 0.42);
      font-weight: 700;
      color: #202227;
      outline: none;
      cursor: pointer;
    }

    .cell.correct {
      background: rgba(23, 114, 63, 0.1);
      border-color: var(--good);
    }

    .cell.incorrect {
      background: rgba(178, 28, 28, 0.1);
      border-color: var(--bad);
    }

    .legend {
      font-size: 14px;
      color: #555;
    }
  </style>
</head>
<body>
  <header>
    <h1>Mnożenie i dzielenie w zakresie 0–30</h1>
    <p>Wstaw brakujące liczby, aby równania w labiryncie były prawdziwe. Kliknij pole i wpisz liczbę.</p>
    <div class="status" id="status"></div>
    <div class="legend">Zakres liczb: 0–30</div>
  </header>

  <section class="maze-wrapper">
    <div class="maze" id="maze"></div>
  </section>

  <script>
    const mazeElement = document.getElementById("maze");
    const statusElement = document.getElementById("status");

    const rows = 13;
    const cols = 17;
    document.documentElement.style.setProperty("--rows", rows);
    document.documentElement.style.setProperty("--cols", cols);

    const grid = Array.from({ length: rows }, () => Array.from({ length: cols }, () => null));

    const setCell = (row, col, cell) => {
      grid[row][col] = cell;
    };

    const placeHorizontal = (row, colStart, items) => {
      items.forEach((item, index) => setCell(row, colStart + index, item));
    };

    const placeVertical = (rowStart, col, items) => {
      items.forEach((item, index) => setCell(rowStart + index, col, item));
    };

    const inputCell = (answer) => ({ type: "input", answer: String(answer) });

    placeHorizontal(1, 1, ["10", "·", inputCell(3), "=", "30"]);
    placeVertical(1, 1, ["10", "=", "5", "·", inputCell(2)]);
    placeHorizontal(3, 3, ["5", "·", inputCell(5), "=", "25"]);
    placeVertical(1, 5, ["30", ":", inputCell(5), "=", "6"]);
    placeHorizontal(5, 1, [inputCell(2), "·", "6", "=", "12"]);
    placeVertical(2, 9, ["16", ":", "4", "=", "4"]);
    placeHorizontal(6, 9, ["4", "·", inputCell(5), "=", "20"]);
    placeHorizontal(7, 3, ["9", "·", inputCell(3), "=", "27"]);
    placeHorizontal(9, 6, ["7", "·", inputCell(4), "=", "28"]);
    placeVertical(6, 13, ["20", ":", "4", "=", "5"]);
    placeHorizontal(10, 1, ["21", ":", "7", "=", "3"]);

    const inputs = [];

    function renderGrid() {
      mazeElement.innerHTML = "";
      grid.forEach((row) => {
        row.forEach((cell) => {
          const cellElement = document.createElement("div");
          cellElement.className = "cell";

          if (!cell) {
            cellElement.classList.add("empty");
            mazeElement.appendChild(cellElement);
            return;
          }

          if (typeof cell === "string") {
            cellElement.textContent = cell;
          } else if (cell.type === "input") {
            const input = document.createElement("input");
            input.setAttribute("inputmode", "numeric");
            input.setAttribute("maxlength", "2");
            input.dataset.answer = cell.answer;
            input.addEventListener("input", () => validateInput(input, cellElement));
            input.addEventListener("focus", () => input.select());
            cellElement.appendChild(input);
            inputs.push(input);
          }

          mazeElement.appendChild(cellElement);
        });
      });
    }

    function validateInput(input, cellElement) {
      const value = input.value.trim();
      const answer = input.dataset.answer;
      cellElement.classList.remove("correct", "incorrect");
      if (!value) {
        updateStatus();
        return;
      }
      if (value === answer) {
        cellElement.classList.add("correct");
      } else {
        cellElement.classList.add("incorrect");
      }
      updateStatus();
    }

    function updateStatus() {
      const correct = inputs.filter((input) => input.value.trim() === input.dataset.answer);
      statusElement.textContent = `Poprawne: ${correct.length} / ${inputs.length}`;
    }

    function updateCellSize() {
      const availableWidth = window.innerWidth - 48;
      const availableHeight = window.innerHeight - 170;
      const size = Math.floor(Math.min(availableWidth / cols, availableHeight / rows));
      const cellSize = Math.max(24, size);
      document.documentElement.style.setProperty("--cell-size", `${cellSize}px`);
    }

    window.addEventListener("resize", updateCellSize);
    updateCellSize();
    renderGrid();
    updateStatus();
  </script>
</body>
</html>
